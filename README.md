# ๐ ะัะพะทัะฐัะฝัะน ัะปัะท ั SOCKS-ะฟัะพะบัะธัะพะฒะฐะฝะธะตะผ

ะจะปัะท ะดะปั ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธั ััะฐัะธะบะฐ ัะตัะตะท SOCKS-ะฟัะพะบัะธ ะฝะฐ ะพัะฝะพะฒะต ัะฟะธัะบะฐ ะดะพะผะตะฝะพะฒ. ะะตัะตะฝะธะต ะดะปั ะพัะณะฐะฝะธะทะฐัะธะธ ะฑะตะทะพะฟะฐัะฝะพะณะพ ะดะพัััะฟะฐ ะธ ะผะพะฝะธัะพัะธะฝะณะฐ ัะตัะตะฒะพะน ะฐะบัะธะฒะฝะพััะธ. ๐

## โจ ะัะพะฑะตะฝะฝะพััะธ

- ๐ ะะฒัะพะผะฐัะธัะตัะบะพะต ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธะต ััะฐัะธะบะฐ ะดะปั ะทะฐะดะฐะฝะฝัั ะดะพะผะตะฝะพะฒ/IP ัะตัะตะท ะฟัะพะบัะธ  
- ๐ ะะพะดะดะตัะถะบะฐ ัะฐะทะปะธัะฝัั ัะธะฟะพะฒ WAN-ะฟะพะดะบะปััะตะฝะธะน:
  - ๐ DHCP
  - ๐ ะกัะฐัะธัะตัะบะธะน IP
  - ๐ก PPPoE
  - ๐ L2TP
- ๐ ะะธะฝะฐะผะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต IP-ะฐะดัะตัะพะฒ ะดะพะผะตะฝะพะฒ
- ๐ก๏ธ ะะฝัะตะณัะฐัะธั ั SOCKS5 ะฟัะพะบัะธ
- ๐ ะะพะณะธัะพะฒะฐะฝะธะต ะฒัะตั ะพะฟะตัะฐัะธะน
- ๐ง ะะพะดัะปัะฝะฐั ะฐััะธัะตะบัััะฐ ั ะฟะพะดะดะตัะถะบะพะน ะฟะฐัะฐะผะตััะพะฒ ะบะพะผะฐะฝะดะฝะพะน ัััะพะบะธ

## ๐ฅ๏ธ ะขัะตะฑะพะฒะฐะฝะธั

- ะกะตัะฒะตั/ะะ ั Linux (ัะตะบะพะผะตะฝะดัะตััั Ubuntu 22.04+)
- ะะฒะฐ ัะตัะตะฒัั ะธะฝัะตััะตะนัะฐ (LAN/WAN)

## ๐ก ะััะธัะตะบัััะฐ ัะธััะตะผั

```mermaid
graph LR
    A[ะะพะบะฐะปัะฝะฐั ัะตัั] --> B(LAN ะะฝัะตััะตะนั)
    B --> C{ะัะพะฒะตัะบะฐ ะฟัะฐะฒะธะป}
    C -->|ะกะพะฒะฟะฐะดะตะฝะธะต| D[SOCKS ะัะพะบัะธ]
    C -->|ะะตั ัะพะฒะฟะฐะดะตะฝะธั| E[ะััะผะพะต ะฟะพะดะบะปััะตะฝะธะต]
    D --> F[WAN ะะฝัะตััะตะนั]
    E --> F
```

## ๐ ะัััััะน ััะฐัั

### ๐ฅ ะฃััะฐะฝะพะฒะบะฐ
1. ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน:
```bash
git clone https://github.com/Divarion-D/transparent-proxy-gateway.git
cd transparent-proxy-gateway
```

2. ะะฐะฟัััะธัะต ัััะฐะฝะพะฒะบั:
```bash
chmod +x proxy.sh
sudo ./proxy.sh --install
```

3. ะกะปะตะดัะนัะต ะธะฝััััะบัะธัะผ ะฝะฐ ัะบัะฐะฝะต:
   - ๐ง ะัะฑะตัะธัะต LAN ะธ WAN ะธะฝัะตััะตะนัั
   - ๐ ะะฐัััะพะนัะต ัะธะฟ WAN-ะฟะพะดะบะปััะตะฝะธั

### โ๏ธ ะะพะฝัะธะณััะฐัะธั

1. ะะพะฑะฐะฒััะต ะดะพะผะตะฝั ะฒ `config/domains.txt`:
```bash
sudo nano config/domains.txt
```

2. ะะพะฑะฐะฒััะต IP ะฒ `config/ips.txt`:
```bash
sudo nano config/ips.txt
```

3. ะะฐัััะพะนัะต ะฟัะพะบัะธ ะฒ `config/redsocks.conf`:
```bash
sudo nano config/redsocks.conf
```

```ini
redsocks {
    local_ip = 0.0.0.0; # ะะต ะธะทะผะตะฝััั
    local_port = 12345; # ะะต ะธะทะผะตะฝััั
    ip = proxy_ip; # ะะดัะตั SOCKS-ะฟัะพะบัะธ
    port = proxy_port; # ะะพัั ะฟัะพะบัะธ
    # login = proxy_login; # ะะผั ะฟะพะปัะทะพะฒะฐัะตะปั ะฟัะพะบัะธ
    # password = proxy_password; # ะะฐัะพะปั ะฟัะพะบัะธ
    type = socks5;
}
```

ะะฐัะบะพะผะผะตะฝัะธััะนัะต ัััะพะบะธ ั ะปะพะณะธะฝะพะผ ะธ ะฟะฐัะพะปะตะผ ะตัะปะธ ััะตะฑัะตััั ะฐััะตะฝัะธัะธะบะฐัะธั:
```
login = proxy_login;
password = proxy_password;
```

4. ะัะธะผะตะฝะธัะต ะธะทะผะตะฝะตะฝะธั:
```bash
sudo ./proxy.sh --update-ips
```

## ๐๏ธ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ๐ ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั

| ะะพะผะฐะฝะดะฐ                     | ะะฟะธัะฐะฝะธะต                          |
|-----------------------------|-----------------------------------|
| `sudo ./proxy.sh --install` | ๐ ะะพะปะฝะฐั ัััะฐะฝะพะฒะบะฐ ัะธััะตะผั       |
| `sudo ./proxy.sh --wan`     | ๐ ะะตัะตะฝะฐัััะพะนะบะฐ WAN-ะฟะพะดะบะปััะตะฝะธั  |
| `sudo ./proxy.sh --update-ips`  | ๐ ะัะธะฝัะดะธัะตะปัะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต IP ะธ ะฟะตัะตะทะฐะฟััะบ REDSOCKS  |
| `sudo ./proxy.sh --help`    | ๐ ะะพะบะฐะทะฐัั ัะฟัะฐะฒะบั               |

### ๐ ะัะธะผะตัั

1. ๐ ะะฑะฝะพะฒะธัั ัะฟะธัะพะบ IP-ะฐะดัะตัะพะฒ:
```bash
sudo ./proxy.sh --update-ips
```

2. โ๏ธ ะะทะผะตะฝะธัั ัะธะฟ WAN-ะฟะพะดะบะปััะตะฝะธั:
```bash
sudo ./proxy.sh --wan
```

3. ๐ ะัะพะฒะตัะธัั ััะฐััั ัะตัะฒะธัะพะฒ:
```bash
systemctl status redsocks
```

4. ๐ ะัะพะฒะตัะธัั ะดะพะฑะฐะฒะปะตะฝะฝัะต IP-ะฐะดัะตัะฐ ะดะพะผะตะฝะพะฒ:
```bash
ipset list proxy_domains
```

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
/transparent-proxy-gateway/
โโโ proxy.sh              # ๐ฅ๏ธ ะัะฝะพะฒะฝะพะน ัะบัะธะฟั
โโโ config.sh             # ๐ฅ๏ธ ะะปะฐะฒะฝัะน ัะฐะนะป ะบะพะฝัะธะณััะฐัะธะธ
โโโ config/
โ   โโโ redsocks.conf     # โ๏ธ ะะพะฝัะธะณััะฐัะธั ะฟัะพะบัะธ
โ   โโโ domains.txt       # ๐ ะกะฟะธัะพะบ ะดะพะผะตะฝะพะฒ ะดะปั ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธั
โ   โโโ ips.txt           # ๐ ะกะฟะธัะพะบ IP ะดะปั ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธั
โ   โโโ cache.txt         # ๐ ะะตั ั ะพะฑัะฐะฑะพัะฐะฝัะผะธ IP ะดะปั ะฟะตัะตะฝะฐะฟัะฐะฒะปะตะฝะธั
โโโ scripts/
โ   โโโ update_ips.sh     # ๐ ะกะบัะธะฟั ะพะฑะฝะพะฒะปะตะฝะธั IP
โโโ logs/                 # ๐๏ธ ะะธัะตะบัะพัะธั ะปะพะณะพะฒ
```

## ๐ ะะพะณะธัะพะฒะฐะฝะธะต

ะัะต ะพะฟะตัะฐัะธะธ ะทะฐะฟะธััะฒะฐัััั ะฒ ะฟะฐะฟะบั `logs/`. ะะปั ะผะพะฝะธัะพัะธะฝะณะฐ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ:

```bash
tail -f logs/redsocks/redsocks.log
```

## โ ะงะฐัััะต ะฒะพะฟัะพัั

### โ ะะตั ะธะฝัะตัะฝะตั-ะดะพัััะฟะฐ ะฟะพัะปะต ะฝะฐัััะพะนะบะธ
1. ๐ ะัะพะฒะตัััะต ัะธะทะธัะตัะบะพะต ะฟะพะดะบะปััะตะฝะธะต ะบะฐะฑะตะปะตะน
2. โ๏ธ ะฃะฑะตะดะธัะตัั ะฒ ะฟัะฐะฒะธะปัะฝะพััะธ ะฒัะฑะพัะฐ WAN-ะธะฝัะตััะตะนัะฐ
3. ๐ต๏ธโโ๏ธ ะัะพะฒะตัััะต ะฝะฐัััะพะนะบะธ ะฟัะพะบัะธ ะฒ `redsocks.conf`

### ๐ซ ะะพะผะตะฝั ะฝะต ะฟะตัะตะฝะฐะฟัะฐะฒะปััััั
1. ๐ ะฃะฑะตะดะธัะตัั, ััะพ ะดะพะผะตะฝั ะดะพะฑะฐะฒะปะตะฝั ะฒ `domains.txt`
2. ๐ ะัะฟะพะปะฝะธัะต ะฟัะธะฝัะดะธัะตะปัะฝะพะต ะพะฑะฝะพะฒะปะตะฝะธะต IP:
```bash
sudo ./proxy.sh --update-ips
```

### โ๏ธ ะัะธะฑะบะธ ะฒ ะบะพะฝัะธะณััะฐัะธะธ
ะัะพะฒะตัััะต ัะธะฝัะฐะบัะธั ัะฐะนะปะพะฒ:
```bash
redsocks --test -c config/redsocks.conf
```

## ๐ ะะธัะตะฝะทะธั

AGPL License. ะะพะดัะพะฑะฝะตะต ัะผ. ะฒ ัะฐะนะปะต [LICENSE](LICENSE).

---

**๐ป ะะฐะทัะฐะฑะพัะฐะฝะพ**: Divarion-D  
**๐ ะะตะฟะพะทะธัะพัะธะน**: https://github.com/Divarion-D/transparent-proxy-gateway

